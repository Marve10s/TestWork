---
import { Image } from 'astro:assets';
import extensionImg from '@assets/home/extension.png';
import { Icon } from 'astro-icon/components';

interface Props {
  url?: string;
}

const { 
  url = 'https://docs.ultralytics.com/pt/'
} = Astro.props;
---

<div class="bg-[#171A24] rounded-2xl p-8 lg:col-span-1 flex flex-col">
  <div class="flex-1">
    <div class="bg-white/[0.07] rounded-2xl px-6 pt-6">
      <h3 class="text-sm mb-4 text-center pb-4 border-b border-[#444650]">
        Convert this page
      </h3>

      <div class="bg-white/[0.12] rounded-xl p-3 flex items-center gap-3 mb-6 relative">
        <button 
          class="copy-btn transition-transform duration-200 hover:scale-110 active:scale-95"
          data-url={url}
          aria-label="Copy URL to clipboard"
        >
          <Icon name="link" class="w-4 h-4" />
        </button>
        <span class="text-lg truncate">{url}</span>
        <div class="popup absolute -top-8 left-0 bg-black/80 text-white text-xs py-1 px-2 rounded transition-opacity duration-200 opacity-0">
          Copied to clipboard!
        </div>
      </div>

      <div class="relative">
        <Image 
          src={extensionImg} 
          alt="Chrome Extension Screenshot" 
          class="w-full rounded-lg"
          format="webp"
          loading="lazy"
          quality={90}
        />
      </div>
    </div>
  </div>

  <div class="mt-6">
    <h3 class="text-3xl font-black mb-4">
      Chrome extension
    </h3>

    <p class="text-white/70 text-sm font-light">
      Eu risus sed at turpis eu pharetra. Non turpis lectus eleifend nisl fringilla dui mollis lectus. Magna scelerisque ut et donec.
    </p>
  </div>
</div>

<script>
  document.querySelectorAll('.copy-btn').forEach(button => {
    button.addEventListener('click', async () => {
      const url = button.getAttribute('data-url') || '';
      await navigator.clipboard.writeText(url);
      
      const popup = button.parentElement?.querySelector('.popup');
      if (popup) {
        popup.classList.remove('opacity-0');
        popup.classList.add('opacity-100');
        
        setTimeout(() => {
          popup.classList.remove('opacity-100');
          popup.classList.add('opacity-0');
        }, 2000);
      }
    });
  });
</script>
